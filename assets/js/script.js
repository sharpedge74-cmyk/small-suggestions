function getTableData(){const e=document.querySelector("#table-container table");return Array.from(e.rows).map((e=>Array.from(e.cells).map((e=>e.innerText.trim()))))}function exportToCSV(){let e=getTableData().map((e=>e.map((e=>`"${e}"`)).join(","))).join("\n");const t=new Blob([e],{type:"text/csv"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download=(window.baseFileName||"table")+".csv",n.click(),URL.revokeObjectURL(o)}function exportToXLSX(){const e=getTableData(),t=XLSX.utils.aoa_to_sheet(e),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,t,"Sheet1"),XLSX.writeFile(o,(window.baseFileName||"table")+".xlsx")}function exportToXLS(){const e=getTableData(),t=XLSX.utils.aoa_to_sheet(e),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,t,"Sheet1");const n=XLSX.write(o,{bookType:"xls",type:"array"}),a=new Blob([n],{type:"application/vnd.ms-excel"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=(window.baseFileName||"table")+".xls",l.click(),URL.revokeObjectURL(r)}function exportToJSON(){const e=getTableData(),t=e.shift().map((e=>e.trim().replace(/\s+([a-zA-Z])/g,((e,t)=>t.toUpperCase())).replace(/\s+/g,"").replace(/^[A-Z]/,(e=>e.toLowerCase())))),o=e.map((e=>t.reduce(((t,o,n)=>(t[o]=e[n],t)),{}))),n=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download=(window.baseFileName||"table")+".json",r.click(),URL.revokeObjectURL(a)}function exportToTXT(){let e=getTableData().map((e=>e.join("\t"))).join("\n");const t=new Blob([e],{type:"text/plain"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download="table.txt",n.click(),URL.revokeObjectURL(o)}function exportToHTML(){let e='<table border="1">';e+=getTableData().map((e=>`<tr>${e.map((e=>`<td>${e}</td>`)).join("")}</tr>`)).join(""),e+="</table>";const t=new Blob([e],{type:"text/html"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download=(window.baseFileName||"table")+".html",n.click(),URL.revokeObjectURL(o)}function exportToPDF(){const{jsPDF:e}=window.jspdf;if(!e)return;const t=new e("l","mm","a4"),o=document.querySelector("#table-container table");if(!o)return;const n=Array.from(o.rows).map((e=>Array.from(e.cells).map((e=>e.innerText)))),a=n.shift();t.autoTable({head:[a],body:n,theme:"grid",margin:{top:10}}),t.save((window.baseFileName||"table")+".pdf")}function exportToXML(){const e=getTableData();if(0===e.length)return;const t=e[0],o=e.slice(1);let n='<?xml version="1.0" encoding="UTF-8"?>\n<rows>\n';o.forEach((e=>{n+="  <row>\n",e.forEach(((e,o)=>{const a=t[o].replace(/\s+/g,"_").replace(/[^\w\-.:]/g,"");n+=`    <${a}>${e}</${a}>\n`})),n+="  </row>\n"})),n+="</rows>";const a=new Blob([n],{type:"application/xml"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download="table.xml",l.click(),URL.revokeObjectURL(r)}function exportToSQL(){const e=document.querySelector("#table-container table");if(!e)return;const t=Array.from(e.rows);if(t.length<2)return;const o=window.baseFileName||"my_table",n=Array.from(t[0].cells).map((e=>e.innerText.trim().replace(/\s+/g,"_"))),a=t.slice(1).map((e=>{const t=Array.from(e.cells).map((e=>`'${e.innerText.trim().replace(/'/g,"''")}'`));return`INSERT INTO ${o} (${n.join(", ")}) VALUES (${t.join(", ")});`})).join("\n"),r=new Blob([a],{type:"text/sql"}),l=URL.createObjectURL(r),c=document.createElement("a");c.href=l,c.download=`${o}.sql`,c.click(),URL.revokeObjectURL(l)}document.getElementById("file-input").addEventListener("change",(function(e){const t=e.target.files[0];if(!t)return;const o=t.name.replace(/\.[^/.]+$/,"");window.baseFileName=o;const n=t.name.toLowerCase().endsWith(".csv");document.getElementById("loader").style.display="block";const a=new FileReader;a.onload=function(e){let t;if(n){const o=e.target.result;t=XLSX.read(o,{type:"string"})}else{const o=new Uint8Array(e.target.result);t=XLSX.read(o,{type:"array"})}const o=t.SheetNames[0],a=t.Sheets[o],r=XLSX.utils.sheet_to_html(a,{header:"",editable:!1,id:"excel-table"});document.getElementById("loader").style.display="none",document.getElementById("exportOptions").style.display="flex",document.getElementById("table-container").innerHTML=r},n?a.readAsText(t):a.readAsArrayBuffer(t)}));